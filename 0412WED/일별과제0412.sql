--1번
SELECT D.DNAME, E.ENAME, E.JOB, E.SAL FROM EMP E, DEPT D
WHERE E.DEPTNO(+) = D.DEPTNO
ORDER BY D.DNAME;

SELECT D.DNAME, E.ENAME, E.JOB, E.SAL FROM EMP E, DEPT D
WHERE E.DEPTNO(+)= D.DEPTNO 
AND E.SAL(+) > 2000;
ORDER BY D.DNAME;

SELECT ENAME, DEPTNO, SAL FROM EMP;
SELECT DNAME, DEPTNO FROM DEPT;

--2번
SELECT E.ENAME||'"S MANAGER IS '||NVL(M.ENAME, 'NOBODY')
FROM EMP E, EMP M
WHERE E.MGR = M.EMPNO(+)
ORDER BY M.ENAME;

--EMP E로 가정
SELECT ENAME, MGR, EMPNO, JOB FROM EMP;
--EMP M으로 가정
SELECT ENAME, MGR, EMPNO, JOB FROM EMP;

SELECT E.ENAME||'"S MANAGER IS '||M.ENAME FROM EMP E, EMP M
WHERE E.MGR = M.EMPNO
ORDER BY M.ENAME;

SELECT E.ENAME||'"S MANAGER IS '||M.ENAME FROM EMP E, EMP M
WHERE E.MGR = M.EMPNO(+)
ORDER BY M.ENAME;

--4번문제
SELECT * FROM EMP;
SELECT * FROM DEPT;

SELECT D.DEPTNO AS "부서번호,", E.ENAME AS "이름,", E.JOB AS "직업,", E.SAL AS "급여", 
       (SELECT COUNT(DISTINCT E2.SAL) 
        FROM EMP E2 
        WHERE E2.SAL >= E.SAL AND E2.DEPTNO = E.DEPTNO) AS "급여순위"
FROM EMP E, DEPT D
WHERE E.DEPTNO(+) = D.DEPTNO 
ORDER BY D.DEPTNO ASC, E.SAL DESC;

--5번 문제
SELECT D.DEPTNO AS "부서번호,", E.ENAME AS "이름,", E.JOB AS "직업,", E.SAL AS "급여", 
       DENSE_RANK() OVER (PARTITION BY D.DEPTNO ORDER BY E.SAL DESC) "급여순위"
FROM EMP E, DEPT D
WHERE E.DEPTNO(+) = D.DEPTNO 
ORDER BY D.DEPTNO ASC, E.SAL DESC;